<?php
  if ($_SERVER['REQUEST_METHOD'] === 'PUT') {
    $data = file_get_contents("php://input");
    
    $uri = parse_url($_SERVER['REQUEST_URI']);

    if(isset($uri['path'])){
      $path = $uri['path'];
    }else{
      $path = '/';
    }

    $file_path = "uploads/" . $path;
    if($path != "uploads/") {
      file_put_contents($file_path, $data);
      echo "<a href='". htmlentities($file_path) ."'>See the image!</a>";
    }  else {
      echo "File upload failed";
    }
    die();
  }
?>

<html>
<?php include 'menue/header.php';?>
<body>
<?php include 'menue/navbar.php';?>
<h1>Scenario 15</h1>
<p>This scenario implements a file upload using PUT requests.</p>
<div class="container mt-5">
        <h1 class="text-center">File Updater</h1>
        <br>
        <div id="fileGrid" class="row">
            <!-- The list of files will be dynamically generated here -->
        </div>
        <div class="update-section mt-4" style="display: none;">
            <h2>Update File</h2>
            <form id="updateForm">
                <input type="hidden" id="filename" name="filename">
                <textarea id="newContent" class="form-control" rows="5" placeholder="Enter new content"></textarea>
                <button type="submit" class="btn btn-primary mt-3">Update File</button>
            </form>
        </div>
    </div>

    <?php include 'menue/footer.php'; ?>
    <script src="/js/script.js"></script>
</body>
</html>