FUEL-FileUploadExploitationLab
===============================
FUEL is an abbreviation for `File Upload Exploitation Lab` that aims to be a modular, extensible and simple framework to evaluate unrestricted file upload (UFU) vulnerabilities or vulnerability scanners.
It encompasses 15 unique UFU scenarios with bypassable file validation checks.
While the 15 scenarios primarily focus on PHP-based UFU vulnerabilities, FUEL in itself is language-agnostic and we welcome contributions to extend FUEL with scenarios covering other languages.
Detailed information about each scenario can be found within a scenario's README.

FUEL was used to evaluate four state-of-the-art UFU vulnerability scanners. The results of the evaluation can be found in [FUEL-Evaluation](https://github.com/FUEL-Project/FUEL-Evaluation).
The academic paper titled `Bringing UFUs Back into the Air With FUEL: A Framework for Evaluating the Effectiveness of Unrestricted File Upload Vulnerability Scanners` is to be published at [DIMVA 2024](https://www.dimva.org/dimva2024/).

# Requirements

In order to use FUEL, you need the following software installed:

- Docker
- Docker compose extension
- Git

# Usage

Clone the repository to a directory on your system:

```
git clone https://github.com/FUEL-Project/FUEL-FileUploadExploitationLab.git
```

Change into the directory:

```
cd FUEL-FileUploadExploitationLab/FUEL/
```

And then bring up the file upload scenarios with docker compose:

```
sudo docker compose up --build
``` 

Each scenario is mapped to one port on the Docker host:

- Scenario 1 -> Port 10001
- Scenario 2 -> Port 10002
- Scenario 3 -> Port 10003
- Scenario N -> Port 10000 + N

You can find the main menue at any scenario's port in `/menue/`, i.e., 'http://localhost:10001/menue/'. 

To reset FUEL for a new evaluation round, it is enough to stop and restart the containers:

```
sudo docker compose down
sudo docker compose up --build --force-recreate
```

# Contributions

We welcome contributions to FUSE, especially new UFU scenarios.

Please open a pull request on GitHub for us to review and merge. 

## Extending FUEL

To extend FUEL, create a new subfolder `scenarioX` and create a `Dockerfile` defining how the respective Docker container will be build. 
The container should include the vulnerable web application, a web server and all other dependencies for it work.
If possible, the web application should include a link back to `/menue/`, but this is optional.


Then, a free port and IP address should be chosen. If possible, these should be `Port: 10000+X` and `IP: 172.22.1.X`. 
Finally, the `docker-compose.yml` must be extended with the new scenario's container definition and replacing `<Port>` with the new port and `<IP>` with the new IP:

```
scenarioX:
build:
  context: ./scenarioX
  dockerfile: Dockerfile
ports:
  - '<Port>:80'
volumes:
  - ./menue/:/var/www/html/menue/
networks:
  fuel_network:
    ipv4_address: <IP>
```

# Paper & Authors

This file upload exploitation lab was developed for the academic publication by Sebastian Neef and Maath Oudeh.

If you use the the lab, please cite it as follows:

```
TBD
```

You can find a preprint of the paper [here](TBD) and the camera-ready version [here](TBD)
